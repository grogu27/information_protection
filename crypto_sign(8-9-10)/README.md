# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã ‚Ññ8 –∏ ‚Ññ9 –ø–æ –∑–∞—â–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ (–≠–¶–ü) –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º RSA –∏ –≠–ª—å-–ì–∞–º–∞–ª—è**

---

## üéØ –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è:
- –≤—ã—á–∏—Å–ª—è–µ—Ç —Ö–µ—à –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (SHA-256),
- –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –±–∞–π—Ç —Ö–µ—à–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ **RSA** –∏–ª–∏ **–≠–ª—å-–ì–∞–º–∞–ª—è**,
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª,
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏:
> ¬´–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç, –∏ –∫–∞–∂–¥—ã–π –∏–∑ —ç—Ç–∏—Ö –±–∞–π—Ç –ø–æ–¥–ø–∏—Å–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ, –ø—Ä–∏–º–µ–Ω–∏–≤ –∫ –Ω–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏ —Å –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏¬ª.

---

## üìÅ –§–∞–π–ª—ã, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º–æ–π

–ü—É—Å—Ç—å –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `document.pdf`.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
```bash
./sign_tool rsa document.pdf

```
–°–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã:
document.pdf_sig - –ü–æ–¥–ø–∏—Å—å ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–æ–¥–ø–∏—Å—å –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞ —Ö–µ—à–∞. –î–ª—è RSA ‚Äî —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–æ–≤ –ø–æ 256 –±–∞–π—Ç (2048 –±–∏—Ç). –î–ª—è –≠–ª—å-–ì–∞–º–∞–ª—è ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä (r, s), –∫–∞–∂–¥–∞—è –ø–æ 16 –±–∞–π—Ç (2 √ó 8 –±–∞–π—Ç).

document.pdf_ver - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π VALID –∏–ª–∏ INVALID.

–ö–ª—é—á–∏ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è: 
private.pem, public.pem ‚Äî –¥–ª—è RSA (–≤ —Ñ–æ—Ä–º–∞—Ç–µ PEM),
elgamal_priv.key, elgamal_pub.key ‚Äî –¥–ª—è –≠–ª—å-–ì–∞–º–∞–ª—è (–ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç: p g x / p g y).

## üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞
### üîê –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å (–≠–¶–ü)
–≠–¶–ü ‚Äî –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π:

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (–ø–æ–¥–ø–∏—Å—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –≤–ª–∞–¥–µ–ª—å—Ü—É),
–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω—ë–Ω),
–ù–µ–æ—Ç–∫–∞–∑—É–µ–º–æ—Å—Ç—å (–≤–ª–∞–¥–µ–ª–µ—Ü –Ω–µ –º–æ–∂–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç—å –ø–æ–¥–ø–∏—Å—å).
–û–±—â–∞—è —Å—Ö–µ–º–∞:

–í—ã—á–∏—Å–ª–∏—Ç—å —Ö–µ—à H = Hash(M).
–ü–æ–¥–ø–∏—Å–∞—Ç—å —Ö–µ—à: S = Sign(H, secret_key).
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: Verify(H, S, public_key) ‚Üí true/false.
üî¢ RSA Signature (–õ–† ‚Ññ8)
–ö–ª—é—á–∏:
–ü—Ä–∏–≤–∞—Ç–Ω—ã–π: (d, n)
–ü—É–±–ª–∏—á–Ω—ã–π: (e, n)
–ü–æ–¥–ø–∏—Å—å –±–∞–π—Ç–∞ b:
s = b^d mod n
–ü—Ä–æ–≤–µ—Ä–∫–∞:
b' = s^e mod n, —Å—Ä–∞–≤–Ω–∏—Ç—å b' == b
‚ö†Ô∏è –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç –≤–µ—Å—å —Ö–µ—à, –Ω–æ –ø–æ —É—Å–ª–æ–≤–∏—é ‚Äî –∫–∞–∂–¥—ã–π –±–∞–π—Ç –æ—Ç–¥–µ–ª—å–Ω–æ. 

### üî¢ –≠–ª—å-–ì–∞–º–∞–ª—è (–õ–† ‚Ññ9)
–í—ã–±–∏—Ä–∞–µ—Ç—Å—è –±–æ–ª—å—à–æ–µ –ø—Ä–æ—Å—Ç–æ–µ p, –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å g.
–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á: x ‚àà [1, p‚àí2]
–û—Ç–∫—Ä—ã—Ç—ã–π –∫–ª—é—á: y = g^x mod p
–î–ª—è –ø–æ–¥–ø–∏—Å–∏ –±–∞–π—Ç–∞ m:
–í—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ k, –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ —Å p‚àí1
r = g^k mod p
s = k‚Åª¬π(m ‚àí x¬∑r) mod (p‚àí1)
–ü–æ–¥–ø–∏—Å—å: (r, s)
–ü—Ä–æ–≤–µ—Ä–∫–∞:
g^m ‚â° y^r ¬∑ r^s (mod p)
üí° –í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ p ‚âà 10‚Å∂ (–º–µ–Ω—å—à–µ 10! = 3 628 800), —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é "—Ä–∞–±–æ—Ç–∞ —Å —á–∏—Å–ª–∞–º–∏ –ø–æ—Ä—è–¥–∫–∞ 10!". 

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–¥
1. –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (utils.cpp)
```bash
std::vector<unsigned char> sha256_file(const std::string& filename);
```
–ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –±–ª–æ–∫–∞–º–∏ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç SHA-256 —á–µ—Ä–µ–∑ OpenSSL. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî 32 –±–∞–π—Ç–∞.

2. –ü–æ–¥–ø–∏—Å—å RSA (rsa_sign.cpp)
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 2048-–±–∏—Ç–Ω—ã–π RSA-–∫–ª—é—á.
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞ —Ö–µ—à–∞ –≤—ã–∑—ã–≤–∞–µ—Ç RSA_sign() (–ø–æ–¥–ø–∏—Å—å –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∫–∞–∫ "—Å–æ–æ–±—â–µ–Ω–∏–µ").
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –ø–æ–¥–ø–∏—Å–∏ –ø–æ–¥—Ä—è–¥ –≤ _sig.
–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ ‚Äî —á–∏—Ç–∞–µ—Ç –ø–æ 256 –±–∞–π—Ç (—Ä–∞–∑–º–µ—Ä RSA-–±–ª–æ–∫–∞) –∏ –≤—ã–∑—ã–≤–∞–µ—Ç RSA_verify().

3. –ü–æ–¥–ø–∏—Å—å –≠–ª—å-–ì–∞–º–∞–ª—è (elgamal_sign.cpp)
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ p ‚âà 1 000 000, –Ω–∞—Ö–æ–¥–∏—Ç g ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å.
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á x, –≤—ã—á–∏—Å–ª—è–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π y = g^x mod p.
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–π—Ç–∞ m:
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ k
–í—ã—á–∏—Å–ª—è–µ—Ç (r, s)
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–∫ 16 –±–∞–π—Ç –Ω–∞ –±–∞–π—Ç —Ö–µ—à–∞: 8 –±–∞–π—Ç r + 8 –±–∞–π—Ç s.
–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç (r, s) –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏–µ.